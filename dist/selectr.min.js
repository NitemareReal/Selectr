/*!
 * Selectr 2.4.14
 * http://mobius.ovh/docs/selectr
 *
 * Released under the MIT license
 */
!function(e,t){var i="Selectr";"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t(i):e.Selectr=t(i)}(this,(function(e){"use strict";var t=function(){};t.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){this._events=this._events||{},e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)},emit:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},t.mixin=function(e){for(var i=["on","off","emit"],s=0;s<i.length;s++)"function"==typeof e?e.prototype[i[s]]=t.prototype[i[s]]:e[i[s]]=t.prototype[i[s]];return e};var i={escapeRegExp:function(e){var t=/[\\^$.*+?()[\]{}|]/g,i=new RegExp(t.source);return e&&i.test(e)?e.replace(t,"\\$&"):e},extend:function(e,t){for(var s in t)if(t.hasOwnProperty(s)){var n=t[s];n&&"[object Object]"===Object.prototype.toString.call(n)?(e[s]=e[s]||{},i.extend(e[s],n)):e[s]=n}return e},each:function(e,t,i){if("[object Object]"===Object.prototype.toString.call(e))for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(i,s,e[s],e);else for(var n=0,a=e.length;n<a;n++)t.call(i,n,e[n],e)},createElement:function(e,t){var i,s=document.createElement(e);if(t&&"[object Object]"===Object.prototype.toString.call(t))for(i in t)i in s?s[i]=t[i]:"html"===i?s.innerHTML=t[i]:s.setAttribute(i,t[i]);return s},hasClass:function(e,t){if(e)return e.classList?e.classList.contains(t):!!e.className&&!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){i.hasClass(e,t)||(e.classList?e.classList.add(t):e.className=e.className.trim()+" "+t)},removeClass:function(e,t){i.hasClass(e,t)&&(e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," "))},closest:function(e,t){return e&&e!==document.body&&(t(e)?e:i.closest(e.parentNode,t))},isInt:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},debounce:function(e,t,i){var s;return function(){var n=this,a=arguments,l=function(){s=null,i||e.apply(n,a)},o=i&&!s;clearTimeout(s),s=setTimeout(l,t),o&&e.apply(n,a)}},rect:function(e,t){var i=window,s=e.getBoundingClientRect(),n=t?i.pageXOffset:0,a=t?i.pageYOffset:0;return{bottom:s.bottom+a,height:s.height,left:s.left+n,right:s.right+n,top:s.top+a,width:s.width}},includes:function(e,t){return e.indexOf(t)>-1},startsWith:function(e,t){return e.substr(0,t.length)===t},truncate:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}};function s(e,t){return e.hasOwnProperty(t)&&(!0===e[t]||e[t].length)}function n(e,t,s){e.parentNode?e.parentNode.parentNode||t.appendChild(e.parentNode):t.appendChild(e),i.removeClass(e,"excluded"),s||(e.textContent=e.textContent)}var a=function(){if(this.items.length){var e=document.createDocumentFragment();if(this.config.pagination){var t=this.pages.slice(0,this.pageIndex);i.each(t,(function(t,s){i.each(s,(function(t,i){n(i,e,this.customOption)}),this)}),this)}else i.each(this.items,(function(t,i){n(i,e,this.customOption)}),this);e.childElementCount&&(i.removeClass(this.items[this.navIndex],"active"),this.navIndex=(e.querySelector(".selectr-option.selected")||e.querySelector(".selectr-option")).idx,i.addClass(this.items[this.navIndex],"active")),this.tree.appendChild(e)}},l=function(e){var t=e.target;this.container.contains(t)||!this.opened&&!i.hasClass(this.container,"notice")||this.close()},o=function(e,t){t=t||e;var s={class:("selectr-option "+e.className).trim(),role:"treeitem","aria-selected":!1};this.customOption?s.html=this.config.renderOption(t):s.textContent=e.textContent;var n=i.createElement("li",s);return n.idx=e.idx,this.items.push(n),e.defaultSelected&&this.defaultSelected.push(e.idx),e.disabled&&(n.disabled=!0,i.addClass(n,"disabled")),n},h=function(){var e=!1,t=0;this.el.children.length&&i.each(this.el.children,(function(s,n){"OPTGROUP"===n.nodeName?(e=i.createElement("ul",{class:"selectr-optgroup",role:"group",html:"<li class='selectr-optgroup--label'>"+n.label+"</li>"}),i.each(n.children,(function(i,s){s.idx=t,e.appendChild(o.call(this,s,e)),t++}),this)):(n.idx=t,o.call(this,n),t++)}),this)},c=function(){this.requiresPagination=this.config.pagination&&this.config.pagination>0,void 0!==this.config.width&&(i.isInt(this.config.width)?this.width=this.config.width+"px":"auto"===this.config.width?this.width="100%":i.includes(this.config.width,"%")&&(this.width=this.config.width)),this.container=i.createElement("div",{class:"selectr-container"}),this.config.customClass&&i.addClass(this.container,this.config.customClass),this.mobileDevice&&this.nativeDropdownMobile?i.addClass(this.container,"selectr-mobile"):i.addClass(this.container,"selectr-desktop"),this.el.tabIndex=-1,this.config.nativeDropdown||this.mobileDevice&&this.nativeDropdownMobile?i.addClass(this.el,"selectr-visible"):i.addClass(this.el,"selectr-hidden"),this.selected=i.createElement("div",{class:"selectr-selected",disabled:this.disabled,tabIndex:0,"aria-expanded":!1}),this.label=i.createElement(this.el.multiple?"ul":"span",{class:"selectr-label"});var e,t=i.createElement("div",{class:"selectr-options-container"});if(this.tree=i.createElement("ul",{class:"selectr-options",role:"tree","aria-hidden":!0,"aria-expanded":!1}),this.notice=i.createElement("div",{class:"selectr-notice"}),this.el.setAttribute("aria-hidden",!0),this.disabled&&(this.el.disabled=!0),this.el.multiple?(i.addClass(this.label,"selectr-tags"),i.addClass(this.container,"multiple"),this.tags=[],this.selectedValues=this.config.defaultSelected?this.getSelectedProperties("value"):[],this.selectedIndexes=this.getSelectedProperties("idx")):(this.selectedValue=null,this.selectedIndex=-1),this.selected.appendChild(this.label),this.config.clearable&&(this.selectClear=i.createElement("button",{class:"selectr-clear",type:"button"}),this.container.appendChild(this.selectClear),i.addClass(this.container,"clearable")),this.config.taggable){var n=i.createElement("li",{class:"input-tag"});if(this.input=i.createElement("input",{class:"selectr-tag-input",placeholder:this.config.tagPlaceholder,tagIndex:0,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",role:"textbox",type:"search"}),n.appendChild(this.input),this.label.appendChild(n),i.addClass(this.container,"taggable"),this.tagSeperators=[","],this.config.tagSeperators){this.tagSeperators=this.tagSeperators.concat(this.config.tagSeperators);for(var a=[],l=0;l<this.tagSeperators.length;l++)a.push(i.escapeRegExp(this.tagSeperators[l]));this.tagSeperatorsRegex=new RegExp(a.join("|"),"i")}else this.tagSeperatorsRegex=new RegExp(",","i")}if(this.config.searchable&&(this.input=i.createElement("input",{class:"selectr-input",tagIndex:-1,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",role:"textbox",type:"search",placeholder:this.config.messages.searchPlaceholder}),this.inputClear=i.createElement("button",{class:"selectr-input-clear",type:"button"}),this.inputContainer=i.createElement("div",{class:"selectr-input-container"}),this.inputContainer.appendChild(this.input),this.inputContainer.appendChild(this.inputClear),t.appendChild(this.inputContainer)),t.appendChild(this.notice),t.appendChild(this.tree),this.items=[],this.options=[],this.el.options.length&&(this.options=[].slice.call(this.el.options)),h.call(this),this.config.data&&Array.isArray(this.config.data)){this.data=[];var c,r=!1;group=!1,j=0,i.each(this.config.data,(function(e,t){s(t,"children")?(r=i.createElement("optgroup",{label:t.text}),group=i.createElement("ul",{class:"selectr-optgroup",role:"group",html:"<li class='selectr-optgroup--label'>"+t.text+"</li>"}),i.each(t.children,(function(e,t){(c=new Option(t.text,t.value,!1,t.hasOwnProperty("selected")&&!0===t.selected)).disabled=s(t,"disabled"),this.options.push(c),r.appendChild(c),c.idx=j,group.appendChild(o.call(this,c,t)),this.data[j]=t,j++}),this),this.el.appendChild(r)):((c=new Option(t.text,t.value,!1,t.hasOwnProperty("selected")&&!0===t.selected)).disabled=s(t,"disabled"),this.options.push(c),c.idx=j,o.call(this,c,t),this.data[j]=t,j++)}),this)}this.setSelected(!0),this.navIndex=0;for(var d=0;d<this.items.length;d++)if(e=this.items[d],!i.hasClass(e,"disabled")){i.addClass(e,"active"),this.navIndex=d;break}this.requiresPagination&&(this.pageIndex=1,this.paginate()),this.container.appendChild(this.selected),this.container.appendChild(t),this.placeEl=i.createElement("div",{class:"selectr-placeholder"}),this.setPlaceholder(),this.selected.appendChild(this.placeEl),this.disabled&&this.disable(),this.el.parentNode.insertBefore(this.container,this.el),this.container.appendChild(this.el)},r=function(e){if(e=e||window.event,this.items.length&&this.opened&&i.includes([13,38,40],e.which)){if(e.preventDefault(),13===e.which)return!(this.noResults||this.config.taggable&&this.input.value.length>0)&&this.change(this.navIndex);var t,s=this.items[this.navIndex],n=this.navIndex;switch(e.which){case 38:t=0,this.navIndex>0&&this.navIndex--;break;case 40:t=1,this.navIndex<this.items.length-1&&this.navIndex++;case 27:}for(this.navigating=!0;i.hasClass(this.items[this.navIndex],"disabled")||i.hasClass(this.items[this.navIndex],"excluded");){if(!(this.navIndex>0&&this.navIndex<this.items.length-1)){this.navIndex=n;break}if(t?this.navIndex++:this.navIndex--,this.searching){if(this.navIndex>this.tree.lastElementChild.idx){this.navIndex=this.tree.lastElementChild.idx;break}if(this.navIndex<this.tree.firstElementChild.idx){this.navIndex=this.tree.firstElementChild.idx;break}}}var a=i.rect(this.items[this.navIndex]);t?(0===this.navIndex?this.tree.scrollTop=0:a.top+a.height>this.optsRect.top+this.optsRect.height&&(this.tree.scrollTop=this.tree.scrollTop+(a.top+a.height-(this.optsRect.top+this.optsRect.height))),this.navIndex===this.tree.childElementCount-1&&this.requiresPagination&&u.call(this)):0===this.navIndex?this.tree.scrollTop=0:a.top-this.optsRect.top<0&&(this.tree.scrollTop=this.tree.scrollTop+(a.top-this.optsRect.top)),s&&i.removeClass(s,"active"),i.addClass(this.items[this.navIndex],"active")}else this.navigating=!1},d=function(e){var t,s=this,n=document.createDocumentFragment(),a=this.options[e.idx],l=this.data?this.data[e.idx]:a,o={class:"selectr-tag "+(l.className?l.className:"").trim()};this.customSelected?o.html=this.config.renderSelection(l):o.textContent=a.textContent;var h=i.createElement("li",o),c=i.createElement("button",{class:"selectr-tag-remove",type:"button"});if(h.appendChild(c),h.idx=e.idx,h.tag=a.value,this.tags.push(h),this.config.sortSelected){var r=this.tags.slice();t=function(e,t){e.replace(/(\d+)|(\D+)/g,(function(e,i,s){t.push([i||1/0,s||""])}))},r.sort((function(e,i){var n,a,l=[],o=[];for(!0===s.config.sortSelected?(n=e.tag,a=i.tag):"text"===s.config.sortSelected&&(n=e.textContent,a=i.textContent),t(n,l),t(a,o);l.length&&o.length;){var h=l.shift(),c=o.shift(),r=h[0]-c[0]||h[1].localeCompare(c[1]);if(r)return r}return l.length-o.length})),i.each(r,(function(e,t){n.appendChild(t)})),this.label.innerHTML=""}else n.appendChild(h);this.config.taggable?this.label.insertBefore(n,this.input.parentNode):this.label.appendChild(n)},p=function(e){var t=!1;i.each(this.tags,(function(i,s){s.idx===e.idx&&(t=s)}),this),t&&(this.label.removeChild(t),this.tags.splice(this.tags.indexOf(t),1))},u=function(){var e=this.tree;if(e.scrollTop>=e.scrollHeight-e.offsetHeight&&this.pageIndex<this.pages.length){var t=document.createDocumentFragment();i.each(this.pages[this.pageIndex],(function(e,i){n(i,t,this.customOption)}),this),e.appendChild(t),this.pageIndex++,this.emit("selectr.paginate",{items:this.items.length,total:this.data.length,page:this.pageIndex,pages:this.pages.length})}},g=function(){(this.config.searchable||this.config.taggable)&&(this.input.value=null,this.searching=!1,this.config.searchable&&i.removeClass(this.inputContainer,"active"),i.hasClass(this.container,"notice")&&(i.removeClass(this.container,"notice"),i.addClass(this.container,"open"),this.input.focus()),i.each(this.items,(function(e,t){i.removeClass(t,"excluded"),this.customOption||(t.textContent=t.textContent)}),this))},f=function(e,t){if(!e)throw new Error("You must supply either a HTMLSelectElement or a CSS3 selector string.");if(!e.dataset.selectr){if(this.el=e,"string"==typeof e&&(this.el=document.querySelector(e)),null===this.el)throw new Error("The element you passed to Selectr can not be found.");if("select"!==this.el.nodeName.toLowerCase())throw new Error("The element you passed to Selectr is not a HTMLSelectElement.");this.render(t)}};return f.prototype.render=function(e){if(!this.rendered){this.el.selectr=this,this.el.dataset.selectr=this,this.config=i.extend({defaultSelected:!0,width:"auto",disabled:!1,disabledMobile:!1,searchable:!0,clearable:!1,sortSelected:!1,allowDeselect:!1,closeOnScroll:!1,nativeDropdown:!1,nativeDropdownMobile:!1,nativeKeyboard:!1,placeholder:"Select an option...",taggable:!1,tagPlaceholder:"Enter a tag...",messages:{noResults:"No results.",noOptions:"No options available.",maxSelections:"A maximum of {max} items can be selected.",tagDuplicate:"That tag is already in use.",searchPlaceholder:"Search options..."}},e),this.originalType=this.el.type,this.originalIndex=this.el.tabIndex,this.defaultSelected=[],this.originalOptionCount=this.el.options.length,(this.config.multiple||this.config.taggable)&&(this.el.multiple=!0),this.disabled=s(this.config,"disabled"),this.opened=!1,this.config.taggable&&(this.config.searchable=!1),this.navigating=!1,this.mobileDevice=!1,!this.config.disabledMobile&&/Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent)&&(this.mobileDevice=!0),this.customOption=this.config.hasOwnProperty("renderOption")&&"function"==typeof this.config.renderOption,this.customSelected=this.config.hasOwnProperty("renderSelection")&&"function"==typeof this.config.renderSelection,this.supportsEventPassiveOption=this.detectEventPassiveOption(),t.mixin(this),c.call(this),this.bindEvents(),this.update(),this.optsRect=i.rect(this.tree),this.rendered=!0,this.el.multiple||(this.el.selectedIndex=this.selectedIndex);var n=this;setTimeout((function(){n.emit("selectr.init")}),20)}},f.prototype.getSelected=function(){return this.el.querySelectorAll("option:checked")},f.prototype.getSelectedProperties=function(e){var t=this.getSelected();return[].slice.call(t).map((function(t){return t[e]})).filter((function(e){return null!=e}))},f.prototype.detectEventPassiveOption=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return e},f.prototype.bindEvents=function(){var e=this;if(this.events={},this.events.dismiss=l.bind(this),this.events.navigate=r.bind(this),this.events.reset=this.reset.bind(this),this.config.nativeDropdown||this.mobileDevice&&this.nativeDropdownMobile){this.container.addEventListener("touchstart",(function(t){t.changedTouches[0].target===e.el&&e.toggle()}),!!this.supportsEventPassiveOption&&{passive:!0}),this.container.addEventListener("click",(function(t){t.target===e.el&&e.toggle()}));this.el.addEventListener("change",(function(t){if(!t.__selfTriggered)if(e.el.multiple){var s=e.getSelectedProperties("idx"),n=function(e,t){for(var i,s=[],n=e.slice(0),a=0;a<t.length;a++)(i=n.indexOf(t[a]))>-1?n.splice(i,1):s.push(t[a]);return[s,n]}(e.selectedIndexes,s);i.each(n[0],(function(t,i){e.select(i)}),e),i.each(n[1],(function(t,i){e.deselect(i)}),e)}else e.el.selectedIndex>-1&&e.select(e.el.selectedIndex)}))}if(this.config.nativeDropdown&&this.container.addEventListener("keydown",(function(t){"Enter"===t.key&&e.selected===document.activeElement&&(e.toggle(),setTimeout((function(){e.el.focus()}),200))})),this.selected.addEventListener("click",(function(t){e.disabled||e.toggle(),t.preventDefault()})),this.config.nativeKeyboard){var t="";this.selected.addEventListener("keydown",(function(i){if(!(e.disabled||e.selected!==document.activeElement||i.altKey||i.ctrlKey||i.metaKey)){if(" "===i.key||!e.opened&&["Enter","ArrowUp","ArrowDown"].indexOf(i.key)>-1)return e.toggle(),i.preventDefault(),void i.stopPropagation();if(i.key.length<=2&&String[String.fromCodePoint?"fromCodePoint":"fromCharCode"](i.key[String.codePointAt?"codePointAt":"charCodeAt"](0))===i.key){if(e.config.multiple)e.open(),e.config.searchable&&(e.input.value=i.key,e.input.focus(),e.search(null,!0));else{null,t+=i.key;var s=e.search(t,!0);s&&s.length&&(e.clear(),e.setValue(s[0].value)),setTimeout((function(){t=""}),1e3)}return i.preventDefault(),void i.stopPropagation()}}})),this.container.addEventListener("keydown",(function(t){e.opened&&"Tab"===t.key&&e.close()})),this.container.addEventListener("keyup",(function(t){e.opened&&"Escape"===t.key&&(e.close(),t.stopPropagation(),e.selected.focus())}))}this.label.addEventListener("click",(function(t){i.hasClass(t.target,"selectr-tag-remove")&&e.deselect(t.target.parentNode.idx)})),this.selectClear&&this.selectClear.addEventListener("click",this.clear.bind(this)),this.tree.addEventListener("mousedown",(function(e){e.preventDefault()})),this.tree.addEventListener("click",(function(t){var s=i.closest(t.target,(function(e){return e&&i.hasClass(e,"selectr-option")}));s&&(i.hasClass(s,"disabled")||(i.hasClass(s,"selected")?(e.el.multiple||!e.el.multiple&&e.config.allowDeselect)&&e.deselect(s.idx):e.select(s.idx),e.opened&&!e.el.multiple&&e.close())),t.preventDefault(),t.stopPropagation()})),this.tree.addEventListener("mouseover",(function(t){i.hasClass(t.target,"selectr-option")&&(i.hasClass(t.target,"disabled")||(i.removeClass(e.items[e.navIndex],"active"),i.addClass(t.target,"active"),e.navIndex=[].slice.call(e.items).indexOf(t.target)))})),this.config.searchable&&(this.input.addEventListener("focus",(function(t){e.searching=!0})),this.input.addEventListener("blur",(function(t){e.searching=!1})),this.input.addEventListener("keyup",(function(t){e.search(),e.config.taggable||(this.value.length?i.addClass(this.parentNode,"active"):i.removeClass(this.parentNode,"active"))})),this.inputClear.addEventListener("click",(function(t){e.input.value=null,g.call(e),e.tree.childElementCount||a.call(e)}))),this.config.taggable&&this.input.addEventListener("keyup",(function(t){if(e.search(),e.config.taggable&&this.value.length){var s=this.value.trim();if(s.length&&(13===t.which||e.tagSeperatorsRegex.test(s))){var n,a=s.replace(e.tagSeperatorsRegex,"");(a=(a=i.escapeRegExp(a)).trim()).length&&(n=e.add({value:a,textContent:a,selected:!0},!0)),n?(e.close(),g.call(e)):(this.value="",e.setMessage(e.config.messages.tagDuplicate))}}})),this.update=i.debounce((function(){e.opened&&e.config.closeOnScroll&&e.close(),e.width&&(e.container.style.width=e.width),e.invert()}),50),this.requiresPagination&&(this.paginateItems=i.debounce((function(){u.call(this)}),50),this.tree.addEventListener("scroll",this.paginateItems.bind(this))),document.addEventListener("click",this.events.dismiss),window.addEventListener("keydown",this.events.navigate),window.addEventListener("resize",this.update),window.addEventListener("scroll",this.update),this.on("selectr.destroy",(function(){document.removeEventListener("click",this.events.dismiss),window.removeEventListener("keydown",this.events.navigate),window.removeEventListener("resize",this.update),window.removeEventListener("scroll",this.update)})),this.el.form&&(this.el.form.addEventListener("reset",this.events.reset),this.on("selectr.destroy",(function(){this.el.form.removeEventListener("reset",this.events.reset)}))),this.selected.addEventListener("focus",(function(e){e.target.parentNode.classList.add("selectr-active")})),this.selected.addEventListener("blur",(function(e){e.target.parentNode.classList.remove("selectr-active")}))},f.prototype.setSelected=function(e){if(this.config.data||this.el.multiple||!this.el.options.length||(0===this.el.selectedIndex&&(this.el.options[0].defaultSelected||this.config.defaultSelected||(this.el.selectedIndex=-1)),this.selectedIndex=this.el.selectedIndex,this.selectedIndex>-1&&this.select(this.selectedIndex)),this.config.multiple&&"select-one"===this.originalType&&!this.config.data&&this.el.options[0].selected&&!this.el.options[0].defaultSelected&&(this.el.options[0].selected=!1),i.each(this.options,(function(e,t){t.selected&&t.defaultSelected&&this.select(t.idx)}),this),this.config.selectedValue&&this.setValue(this.config.selectedValue),this.config.data){!this.el.multiple&&this.config.defaultSelected&&this.el.selectedIndex<0&&this.config.data.length>0&&this.select(0);var t=0;i.each(this.config.data,(function(e,n){s(n,"children")?i.each(n.children,(function(e,i){i.hasOwnProperty("selected")&&!0===i.selected&&this.select(t),t++}),this):(n.hasOwnProperty("selected")&&!0===n.selected&&this.select(t),t++)}),this)}},f.prototype.destroy=function(){this.rendered&&(this.emit("selectr.destroy"),"select-one"===this.originalType&&(this.el.multiple=!1),this.config.data&&(this.el.innerHTML=""),i.removeClass(this.el,"selectr-hidden"),this.container.parentNode.replaceChild(this.el,this.container),this.rendered=!1,delete this.el.selectr)},f.prototype.change=function(e){var t=this.items[e],s=this.options[e];s.disabled||(s.selected&&i.hasClass(t,"selected")?this.deselect(e):this.select(e),this.opened&&!this.el.multiple&&this.close())},f.prototype.select=function(e){var t=this.items[e],s=[].slice.call(this.el.options),n=this.options[e];if(this.el.multiple){if(i.includes(this.selectedIndexes,e))return!1;if(this.config.maxSelections&&this.tags.length===this.config.maxSelections)return this.setMessage(this.config.messages.maxSelections.replace("{max}",this.config.maxSelections),!0),!1;this.selectedValues.push(n.value),this.selectedIndexes.push(e),d.call(this,t)}else{var a=this.data?this.data[e]:n;this.customSelected?this.label.innerHTML=this.config.renderSelection(a):this.label.textContent=n.textContent,this.selectedValue=n.value,this.selectedIndex=e,i.each(this.options,(function(t,s){var n=this.items[t];t!==e&&(n&&i.removeClass(n,"selected"),s.selected=!1,s.removeAttribute("selected"))}),this)}if(i.includes(s,n)||this.el.add(n),t.setAttribute("aria-selected",!0),i.addClass(t,"selected"),i.addClass(this.container,"has-selected"),n.selected=!0,n.setAttribute("selected",""),this.emit("selectr.change",n),this.emit("selectr.select",n),"createEvent"in document){var l=document.createEvent("HTMLEvents");l.initEvent("change",!0,!0),l.__selfTriggered=!0,this.el.dispatchEvent(l)}else this.el.fireEvent("onchange")},f.prototype.deselect=function(e,t){var s=this.items[e],n=this.options[e];if(this.el.multiple){var a=this.selectedIndexes.indexOf(e);this.selectedIndexes.splice(a,1);var l=this.selectedValues.indexOf(n.value);this.selectedValues.splice(l,1),p.call(this,s),this.tags.length||i.removeClass(this.container,"has-selected")}else{if(!t&&!this.config.clearable&&!this.config.allowDeselect)return!1;this.label.innerHTML="",this.selectedValue=null,this.el.selectedIndex=this.selectedIndex=-1,i.removeClass(this.container,"has-selected")}if(this.items[e].setAttribute("aria-selected",!1),i.removeClass(this.items[e],"selected"),n.selected=!1,n.removeAttribute("selected"),this.emit("selectr.change",null),this.emit("selectr.deselect",n),"createEvent"in document){var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!0),o.__selfTriggered=!0,this.el.dispatchEvent(o)}else this.el.fireEvent("onchange")},f.prototype.setValue=function(e){var t=Array.isArray(e);if(t||(e=e.toString().trim()),!this.el.multiple&&t)return!1;i.each(this.options,(function(i,s){(t&&e.indexOf(s.value)>-1||s.value===e)&&this.change(s.idx)}),this)},f.prototype.getValue=function(e,t){var s;if(this.el.multiple)e?this.selectedIndexes.length&&((s={}).values=[],i.each(this.selectedIndexes,(function(e,t){var i=this.options[t];s.values[e]={value:i.value,text:i.textContent}}),this)):s=this.selectedValues.slice();else if(e){var n=this.options[this.selectedIndex];s={value:n.value,text:n.textContent}}else s=this.selectedValue;return e&&t&&(s=JSON.stringify(s)),s},f.prototype.add=function(e,t){if(e){if(this.data=this.data||[],this.items=this.items||[],this.options=this.options||[],Array.isArray(e))i.each(e,(function(e,i){this.add(i,t)}),this);else if("[object Object]"===Object.prototype.toString.call(e)){if(t){var s=!1;if(i.each(this.options,(function(t,i){i.value.toLowerCase()===e.value.toLowerCase()&&(s=!0)})),s)return!1}var n=i.createElement("option",e);return this.data.push(e),this.mobileDevice&&this.nativeDropdownMobile&&this.el.add(n),this.options.push(n),n.idx=this.options.length>0?this.options.length-1:0,o.call(this,n),e.selected&&this.select(n.idx),this.setPlaceholder(),n}return this.config.pagination&&this.paginate(),!0}},f.prototype.remove=function(e){var t,s=[];(Array.isArray(e)?i.each(e,(function(e,t){i.isInt(t)?s.push(this.getOptionByIndex(t)):"string"==typeof t&&s.push(this.getOptionByValue(t))}),this):i.isInt(e)?s.push(this.getOptionByIndex(e)):"string"==typeof e&&s.push(this.getOptionByValue(e)),s.length)&&(i.each(s,(function(e,s){t=s.idx,this.el.remove(t),this.options.splice(t,1);var n=this.items[t].parentNode;n&&n.removeChild(this.items[t]),this.items.splice(t,1),i.each(this.options,(function(e,t){t.idx=e,this.items[e].idx=e}),this)}),this),this.setPlaceholder(),this.config.pagination&&this.paginate())},f.prototype.removeAll=function(){this.clear(!0),i.each(this.el.options,(function(e,t){this.el.remove(t)}),this),i.truncate(this.tree),this.items=[],this.options=[],this.data=[],this.navIndex=0,this.requiresPagination&&(this.requiresPagination=!1,this.pageIndex=1,this.pages=[]),this.setPlaceholder()},f.prototype.search=function(e,t){if(!this.navigating){var s=!1;e||(e=this.input.value,s=!0,this.removeMessage(),i.truncate(this.tree));var l=[],o=document.createDocumentFragment();if((e=e.trim().toLowerCase()).length>0){var h=t?i.startsWith:i.includes;if(i.each(this.options,(function(t,a){var c=this.items[a.idx];h(a.textContent.trim().toLowerCase(),e)&&!a.disabled?(l.push({text:a.textContent,value:a.value}),s&&(n(c,o,this.customOption),i.removeClass(c,"excluded"),this.customOption||function(e,t){var i=t.textContent,s=new RegExp(e,"ig"),n=s.exec(i);if(n){t.innerHTML="";var a=document.createElement("span");return a.classList.add("selectr-match"),a.textContent=n[0],t.appendChild(document.createTextNode(i.substring(0,n.index))),t.appendChild(a),t.appendChild(document.createTextNode(i.substring(s.lastIndex))),!0}}(e,a))):s&&i.addClass(c,"excluded")}),this),s){if(o.childElementCount){var c=this.items[this.navIndex],r=o.querySelector(".selectr-option:not(.excluded)");this.noResults=!1,i.removeClass(c,"active"),this.navIndex=r.idx,i.addClass(r,"active")}else this.config.taggable||(this.noResults=!0,this.setMessage(this.config.messages.noResults));this.tree.appendChild(o)}}else a.call(this);return l}},f.prototype.toggle=function(){this.disabled||(this.opened?this.close():this.open())},f.prototype.open=function(){var e=this;return!!this.options.length&&(this.opened||this.emit("selectr.open"),this.opened=!0,this.config.nativeDropdown||this.mobileDevice&&this.nativeDropdownMobile?(i.addClass(this.container,"native-open"),void(this.config.data&&0===this.el.options.length&&i.each(this.options,(function(e,t){this.el.add(t)}),this))):(i.addClass(this.container,"open"),a.call(this),this.invert(),this.tree.scrollTop=0,i.removeClass(this.container,"notice"),this.selected.setAttribute("aria-expanded",!0),this.tree.setAttribute("aria-hidden",!1),this.tree.setAttribute("aria-expanded",!0),void(this.config.searchable&&!this.config.taggable&&setTimeout((function(){e.input.focus(),e.input.tabIndex=0}),10))))},f.prototype.close=function(){if(this.opened&&this.emit("selectr.close"),this.opened=!1,this.navigating=!1,this.config.nativeDropdown||this.mobileDevice&&this.nativeDropdownMobile)i.removeClass(this.container,"native-open");else{var e=i.hasClass(this.container,"notice");this.config.searchable&&!e&&(this.input.blur(),this.input.tabIndex=-1,this.searching=!1),e&&(i.removeClass(this.container,"notice"),this.notice.textContent=""),i.removeClass(this.container,"open"),i.removeClass(this.container,"native-open"),this.selected.setAttribute("aria-expanded",!1),this.tree.setAttribute("aria-hidden",!0),this.tree.setAttribute("aria-expanded",!1),i.truncate(this.tree),g.call(this)}},f.prototype.enable=function(){this.disabled=!1,this.el.disabled=!1,this.selected.tabIndex=this.originalIndex,this.el.multiple&&i.each(this.tags,(function(e,t){t.lastElementChild.tabIndex=0})),i.removeClass(this.container,"selectr-disabled")},f.prototype.disable=function(e){e||(this.el.disabled=!0),this.selected.tabIndex=-1,this.el.multiple&&i.each(this.tags,(function(e,t){t.lastElementChild.tabIndex=-1})),this.disabled=!0,i.addClass(this.container,"selectr-disabled")},f.prototype.reset=function(){this.disabled||(this.clear(),this.setSelected(!0),i.each(this.defaultSelected,(function(e,t){this.select(t)}),this),this.emit("selectr.reset"))},f.prototype.clear=function(e,t){if(this.el.multiple){if(this.selectedIndexes.length){var s=this.selectedIndexes.slice();t?this.deselect(s.slice(-1)[0]):i.each(s,(function(e,t){this.deselect(t)}),this)}}else this.selectedIndex>-1&&this.deselect(this.selectedIndex,e);this.emit("selectr.clear")},f.prototype.serialise=function(e){var t=[];return i.each(this.options,(function(e,i){var s={value:i.value,text:i.textContent};i.selected&&(s.selected=!0),i.disabled&&(s.disabled=!0),t[e]=s})),e?JSON.stringify(t):t},f.prototype.serialize=function(e){return this.serialise(e)},f.prototype.setPlaceholder=function(e){e=e||this.config.placeholder||this.el.getAttribute("placeholder"),this.options.length||(e=this.config.messages.noOptions),this.placeEl.innerHTML=e},f.prototype.paginate=function(){if(this.items.length){var e=this;return this.pages=this.items.map((function(t,i){return i%e.config.pagination==0?e.items.slice(i,i+e.config.pagination):null})).filter((function(e){return e})),this.pages}},f.prototype.setMessage=function(e,t){t&&this.close(),i.addClass(this.container,"notice"),this.notice.textContent=e},f.prototype.removeMessage=function(){i.removeClass(this.container,"notice"),this.notice.innerHTML=""},f.prototype.invert=function(){var e=i.rect(this.selected),t=this.tree.parentNode.offsetHeight,s=window.innerHeight;e.top+e.height+t>s?(i.addClass(this.container,"inverted"),this.isInverted=!0):(i.removeClass(this.container,"inverted"),this.isInverted=!1),this.optsRect=i.rect(this.tree)},f.prototype.getOptionByIndex=function(e){return this.options[e]},f.prototype.getOptionByValue=function(e){for(var t=!1,i=0,s=this.options.length;i<s;i++)if(this.options[i].value.trim()===e.toString().trim()){t=this.options[i];break}return t},f.prototype.reload=function(){if(i.truncate(this.tree),this.items=[],this.options=[],this.data=[],this.navIndex=0,this.requiresPagination&&(this.requiresPagination=!1,this.pageIndex=1,this.pages=[]),this.el.options.length&&(this.options=[].slice.call(this.el.options)),h.call(this),this.config.data&&Array.isArray(this.config.data)){this.data=[];var e,t=!1;group=!1,j=0,i.each(this.config.data,(function(n,a){s(a,"children")?(t=i.createElement("optgroup",{label:a.text}),group=i.createElement("ul",{class:"selectr-optgroup",role:"group",html:"<li class='selectr-optgroup--label'>"+a.text+"</li>"}),i.each(a.children,(function(i,n){(e=new Option(n.text,n.value,!1,n.hasOwnProperty("selected")&&!0===n.selected)).disabled=s(n,"disabled"),this.options.push(e),t.appendChild(e),e.idx=j,group.appendChild(o.call(this,e,n)),this.data[j]=n,j++}),this),this.el.appendChild(t)):((e=new Option(a.text,a.value,!1,a.hasOwnProperty("selected")&&!0===a.selected)).disabled=s(a,"disabled"),this.options.push(e),e.idx=j,o.call(this,e,a),this.data[j]=a,j++)}),this)}var n;this.navIndex=0;for(var a=0;a<this.items.length;a++)if(n=this.items[a],!i.hasClass(n,"disabled")){i.addClass(n,"active"),this.navIndex=a;break}this.requiresPagination&&(this.pageIndex=1,this.paginate())},f}));